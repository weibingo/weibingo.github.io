<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="监控告警"><meta name="keywords" content="监控"><meta name="author" content="weibingo"><meta name="copyright" content="weibingo"><title>监控告警 | WBINGのBLOG</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.8.0"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css?version=1.8.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer></script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://v1.hitokoto.cn/?encode=js&amp;charset=utf-8&amp;select=.footer_custom_text" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"3FYJCLGPHO","apiKey":"d730ef95ff5ff79a19b74363531c066b","indexName":"prod_weibing-blog","hits":{"per_page":10},"languages":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}.","hits_stats":"${hits} results found in ${time} ms"}},
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 6.3.0"></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E7%9B%91%E6%8E%A7"><span class="toc-number">1.</span> <span class="toc-text">1.监控</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E7%9B%91%E6%8E%A7%E7%9A%84%E7%9B%AE%E7%9A%84"><span class="toc-number">1.0.1.</span> <span class="toc-text">1.1 监控的目的</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E5%A5%BD%E7%9A%84%E7%9B%91%E6%8E%A7%E4%BD%93%E7%B3%BB%E5%BA%94%E8%AF%A5%E5%81%9A%E5%88%B0%E5%93%AA%E4%BA%9B%EF%BC%9F"><span class="toc-number">1.0.2.</span> <span class="toc-text">1.2 好的监控体系应该做到哪些？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E7%9B%91%E6%8E%A7%E6%8C%87%E6%A0%87"><span class="toc-number">1.0.3.</span> <span class="toc-text">1.3 监控指标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-%E7%9B%91%E6%8E%A7%E4%BD%93%E7%B3%BB"><span class="toc-number">1.0.4.</span> <span class="toc-text">1.4 监控体系</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E5%91%8A%E8%AD%A6"><span class="toc-number">2.</span> <span class="toc-text">2.告警</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E6%8A%A5%E8%AD%A6%E7%BA%A7%E5%88%AB%E8%A7%84%E8%8C%83"><span class="toc-number">2.0.1.</span> <span class="toc-text">2.1 报警级别规范</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%91%8A%E8%AD%A6%E6%B2%BB%E7%90%86"><span class="toc-number">2.0.2.</span> <span class="toc-text">2.2 告警治理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">2.0.3.</span> <span class="toc-text">2.3 最佳实践</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://hexo-1256892004.cos.ap-beijing.myqcloud.com/page/avatar.jpg"></div><div class="author-info__name text-center">weibingo</div><div class="author-info__description text-center">BIG DATA探索者,经济迷,浅度摄影,爱好历史,对社会意识,人文感兴趣</div><div class="follow-button"><a target="_blank" rel="noopener" href="https://github.com/weibingo">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">52</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">43</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">21</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://hexo-1256892004.cos.ap-beijing.myqcloud.com/page/top.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">WBINGのBLOG</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a></span></div><div id="post-info"><div id="post-title">监控告警</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-08-20</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E5%90%8E%E7%AB%AF/">后端</a><div class="post-meta-wordcount"><span>Word count: </span><span class="word-count">1.2k</span><span class="post-meta__separator">|</span><span>Reading time: 3 min</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="1-监控"><a href="#1-监控" class="headerlink" title="1.监控"></a>1.监控</h1><h3 id="1-1-监控的目的"><a href="#1-1-监控的目的" class="headerlink" title="1.1 监控的目的"></a>1.1 监控的目的</h3><ul>
<li>了解业务量级增长</li>
<li>感知系统健康度</li>
<li>告警 -&gt; 及时发现问题</li>
</ul>
<p>可用性量化：  MTTF， MTTR，  SLA，  SLO</p>
<h3 id="1-2-好的监控体系应该做到哪些？"><a href="#1-2-好的监控体系应该做到哪些？" class="headerlink" title="1.2 好的监控体系应该做到哪些？"></a>1.2 好的监控体系应该做到哪些？</h3><ul>
<li>指标全面，但不冗余.</li>
<li>报警敏感，但不误报</li>
<li>自动发现问题，以及分析原因</li>
</ul>
<h3 id="1-3-监控指标"><a href="#1-3-监控指标" class="headerlink" title="1.3 监控指标"></a>1.3 监控指标</h3><p><strong>USE</strong>  (<strong>U</strong>tilization <strong>S</strong>aturation and <strong>E</strong>rrors）：  将注意力集中在处理工作负载的资源上。目标是了解这些资源在存在负载时的行为方式。</p>
<ul>
<li>使用率，表示资源用于服务的时间或容量百分比。100% 的使用率，表示容量已经用尽或者全部时间都用于服务。</li>
<li>饱和度，表示资源的繁忙程度，通常与等待队列的长度相关。100% 的饱和度，表示资源无法接受更多的请求。</li>
<li>错误数表示发生错误的事件个数。错误数越多，表明系统的问题越严重。</li>
</ul>
<p><strong>RED</strong>（<strong>R</strong>equest Throughput，<strong>E</strong>rror Rate, <strong>D</strong>uration Time）:    它是由资源提供服务的工作负载行为的外部可见视图</p>
<p><strong>四个黄金信号</strong>:  延迟（Latency），流量（Traffic），错误（Errors）和 饱和度（Saturation）</p>
<span id="more"></span>
<h3 id="1-4-监控体系"><a href="#1-4-监控体系" class="headerlink" title="1.4 监控体系"></a>1.4 监控体系</h3><p><img src="/assets/20220820164352-cyse3y3-image.png"></p>
<p>需要关注的点非常多（机器指标、数据库监控、接口性能、业务指标、异常日志等等），越想越多，越理越乱。   所以需要<strong>分层监控</strong>。</p>
<h1 id="2-告警"><a href="#2-告警" class="headerlink" title="2.告警"></a>2.告警</h1><p>目标:  避免误报、 漏报</p>
<h3 id="2-1-报警级别规范"><a href="#2-1-报警级别规范" class="headerlink" title="2.1 报警级别规范"></a>2.1 报警级别规范</h3><p>每一条告警都有自己的级别，大部分公司对告警分级都有设定，例如某司对告警的级别设定为： P0、P1、P2、P3。不同的告警级别代表通知范围不同、处理紧急度不同。</p>
<table>
<thead>
<tr>
<th>告警级别</th>
<th>告警含义</th>
<th>通知速度</th>
<th>响应速度</th>
<th>误报概率</th>
</tr>
</thead>
<tbody><tr>
<td>P0</td>
<td>大事故的发生，需马上处理</td>
<td>电话 + 短信 + ** + 邮件</td>
<td>第一时间做出响应并处理，响应时间 &lt;&#x3D;10 分钟</td>
<td>0 误报，告警意味着严重的事故 100% 发生</td>
</tr>
<tr>
<td>P1</td>
<td>核心路径有波动，需马上处理</td>
<td>短信 + **</td>
<td>收到报警之后立即响应，响应时间 &lt;&#x3D;30 分钟</td>
<td>0 误报，告警意味着核心接口服务不稳定，有事故或有抖动</td>
</tr>
<tr>
<td>P2</td>
<td>服务有波动，需关注</td>
<td>**</td>
<td>观察系统指标，快速处理，响应时间 &lt;&#x3D;1 小时</td>
<td>允许少量误报</td>
</tr>
<tr>
<td>P3</td>
<td>服务异常信息通知</td>
<td>**</td>
<td>尽快处理</td>
<td>允许少量误报</td>
</tr>
</tbody></table>
<p>对于不同级别的告警一般是这么进行区分：</p>
<ol>
<li>不同阈值相同持续时间。 比如一分钟内 500 次异常定为 P1、1000 次异常定为 P0</li>
<li>相同阈值不同持续时间。 比如 P2 报警持续 5 分钟升级为 P1、P1 报警持续 5 分钟升级为 P0</li>
</ol>
<h3 id="2-2-告警治理"><a href="#2-2-告警治理" class="headerlink" title="2.2 告警治理"></a>2.2 告警治理</h3><p>保证告警精准触达用户，通过技术手段、数据运营，减少冗余告警，提升告警有效性。</p>
<h3 id="2-3-最佳实践"><a href="#2-3-最佳实践" class="headerlink" title="2.3 最佳实践"></a>2.3 最佳实践</h3><ol>
<li>配置有效的告警，需要分析指标特征来对症下药，避免一刀切，千篇一律。</li>
<li>突增突降类指标的监控，需要先定义出“什么是异常？”，再针对异常进行监控，避免直接对原始的、不稳定的指标进行监控告警。</li>
<li>告警分优先级配置时，针对不同优先级侧重点不同，高优告警侧重于准确且及时，低优告警可接受一定的延迟，换取更低的误告警。</li>
<li><strong>告警分时段配置时，不同时段侧重点不同。低频时段阈值宽松处理（避免大量误告警）、高频时段调小检测窗口严格处理（强调灵敏性）。</strong></li>
<li><strong>对于普适性的指标（Host、中间件等）告警配置，尽可能使用模板进行批量配置</strong>，以减少工作量，提升配置可维护性</li>
<li>对于不稳定的指标需进行归一化处理，转换为稳定指标（错误量 → 错误率），提升告警配置的有效性。</li>
<li>对于告警配置项，尽可能使用相对类配置（如波动百分比、基于基线的百分比等等），避免直接以某个固定值为基础进行比较配置。</li>
<li><strong>监控做加法，告警做减法</strong>：监控开发是可以对系统从下而上，全面的进行监控，因为业务、系统是不断变化的，先期全面的监控能减少后续查漏补缺时的开发工作，并且更加全面丰富的监控指标有助于定位线上故障。但是在配置告警策略时，则应该提取当前关键核心的监控指标，来配置告警策略，减少无效告警数量。</li>
</ol>
<p>难点： 接口差异，很难通用</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">weibingo</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://wbice.cn/article/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6.html">https://wbice.cn/article/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%9B%91%E6%8E%A7/">监控</a></div><div class="addthis_inline_share_toolbox pull-right"></div><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=undefined" async></script><nav id="pagination"><div class="prev-post pull-left"><a href="/article/%E7%A0%94%E5%8F%91%E5%B7%A5%E4%BD%9C%E6%96%B9%E6%B3%95%E8%AE%BA.html"><i class="fa fa-chevron-left">  </i><span>研发工作方法论</span></a></div><div class="next-post pull-right"><a href="/article/2021%E6%80%BB%E7%BB%93.html"><span>2021年回顾与感想</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="vcomment"></div><script src="https://cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = 'false' == 'true';
var verify = 'false' == 'true';
var record_ip = '' == 'true';
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  recordIP:record_ip,
  appId:'dEfDWKbVoLq95IOjY2Wucz01-9Nh9j0Va',
  appKey:'CWRYxwiLTYcAG0OcWmKl7Ez0',
  placeholder:'ヾﾉ≧∀≦)o来啊，快活啊，造作啊!',
  avatar:'mm',
  guest_info:guest_info,
  pageSize:'10',
  lang: 'zh-cn'
})</script></div></div><footer class="footer-bg" style="background-image: url(https://hexo-1256892004.cos.ap-beijing.myqcloud.com/page/top.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2017 - 2024 By weibingo</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">hitokoto</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.8.0"></script><script src="/js/fancybox.js?version=1.8.0"></script><script src="/js/sidebar.js?version=1.8.0"></script><script src="/js/copy.js?version=1.8.0"></script><script src="/js/fireworks.js?version=1.8.0"></script><script src="/js/transition.js?version=1.8.0"></script><script src="/js/scroll.js?version=1.8.0"></script><script src="/js/head.js?version=1.8.0"></script><script src="/js/search/algolia.js"></script><script src="/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>